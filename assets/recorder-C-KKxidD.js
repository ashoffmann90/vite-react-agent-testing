var st=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var M=(e,t,r)=>(st(e,t,"read from private field"),r?r.call(e):t.get(e)),Te=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},me=(e,t,r,n)=>(st(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);import{g as it,M as Qe,C as zt,R as Ie,h as at,F as ot,S as lt,s as Yt,I as Pt,Q as Jt,A as Qt}from"./index-DzSGQKjV.js";import{s as dt}from"./stylesheet-evaluator-HEZL3CRr.js";var B;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(B||(B={}));function Xt(e){return e.nodeType===e.ELEMENT_NODE}function Re(e){var t=e==null?void 0:e.host;return(t==null?void 0:t.shadowRoot)===e}function Ne(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function jt(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),e}function qt(e){var t=e.cssText;if(t.split('"').length<3)return t;var r=["@import","url(".concat(JSON.stringify(e.href),")")];return e.layerName===""?r.push("layer"):e.layerName&&r.push("layer(".concat(e.layerName,")")),e.supportsText&&r.push("supports(".concat(e.supportsText,")")),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}function Ve(e){try{var t=e.rules||e.cssRules;return t?jt(Array.from(t).map(At).join("")):null}catch{return null}}function At(e){var t;if(er(e))try{t=Ve(e.styleSheet)||qt(e)}catch{}return $t(t||e.cssText)}function $t(e){if(e.includes(":")){var t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}return e}function er(e){return"styleSheet"in e}var wt=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var r;if(!t)return-1;var n=(r=this.getMeta(t))===null||r===void 0?void 0:r.id;return n??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var r=this,n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(function(s){return r.removeNodeFromMap(s)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,r){var n=r.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,r)},e.prototype.replace=function(t,r){var n=this.getNode(t);if(n){var s=this.nodeMetaMap.get(n);s&&this.nodeMetaMap.set(r,s)}this.idNodeMap.set(t,r)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function tr(){return new wt}function tt(e){var t=e.element,r=e.maskInputOptions,n=e.tagName,s=e.type,a=e.value,l=e.maskInputFn,o=a||"",i=s&&fe(s);return(r[n.toLowerCase()]||i&&r[i])&&(l?o=l(o,t):o="*".repeat(o.length)),o}function fe(e){return e.toLowerCase()}var ct="__rrweb_original__";function rr(e){var t=e.getContext("2d");if(!t)return!0;for(var r=50,n=0;n<e.width;n+=r)for(var s=0;s<e.height;s+=r){var a=t.getImageData,l=ct in a?a[ct]:a,o=new Uint32Array(l.call(t,n,s,Math.min(r,e.width-n),Math.min(r,e.height-s)).data.buffer);if(o.some(function(i){return i!==0}))return!1}return!0}function rt(e){var t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?fe(t):null}var nr=1,sr=new RegExp("[^a-z0-9-_:]"),Ee=-2;function Mt(){return nr++}function ir(e){if(e instanceof HTMLFormElement)return"form";var t=fe(e.tagName);return sr.test(t)?"div":t}function ar(e){var t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}var Ce,ut,or=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,lr=/^(?:[a-z+]+:)?\/\//i,dr=/^www\..*/i,cr=/^(data:)([^,]*),(.*)/i;function Ue(e,t){return(e||"").replace(or,function(r,n,s,a,l,o){var i=s||l||o,c=n||a||"";if(!i)return r;if(lr.test(i)||dr.test(i)||cr.test(i))return"url(".concat(c).concat(i).concat(c,")");if(i[0]==="/")return"url(".concat(c).concat(ar(t)+i).concat(c,")");var d=t.split("/"),u=i.split("/");d.pop();for(var f=0,p=u;f<p.length;f++){var h=p[f];h!=="."&&(h===".."?d.pop():d.push(h))}return"url(".concat(c).concat(d.join("/")).concat(c,")")})}var ur=/^[^ \t\n\r\u000c]+/,hr=/^[, \t\n\r\u000c]+/;function pr(e,t){if(t.trim()==="")return t;var r=0;function n(c){var d,u=c.exec(t.substring(r));return u?(d=u[0],r+=d.length,d):""}for(var s=[];n(hr),!(r>=t.length);){var a=n(ur);if(a.slice(-1)===",")a=ve(e,a.substring(0,a.length-1)),s.push(a);else{var l="";a=ve(e,a);for(var o=!1;;){var i=t.charAt(r);if(i===""){s.push((a+l).trim());break}else if(o)i===")"&&(o=!1);else if(i===","){r+=1,s.push((a+l).trim());break}else i==="("&&(o=!0);l+=i,r+=1}}}return s.join(", ")}function ve(e,t){if(!t||t.trim()==="")return t;var r=e.createElement("a");return r.href=t,r.href}function fr(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function nt(){var e=document.createElement("a");return e.href="",e.href}function kt(e,t,r,n){return n&&(r==="src"||r==="href"&&!(t==="use"&&n[0]==="#")||r==="xlink:href"&&n[0]!=="#"||r==="background"&&(t==="table"||t==="td"||t==="th")?ve(e,n):r==="srcset"?pr(e,n):r==="style"?Ue(n,nt()):t==="object"&&r==="data"?ve(e,n):n)}function Tt(e,t,r){return(e==="video"||e==="audio")&&t==="autoplay"}function gr(e,t,r){try{if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(var n=e.classList.length;n--;){var s=e.classList[n];if(t.test(s))return!0}if(r)return e.matches(r)}catch{}return!1}function Ke(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return r?Ke(e.parentNode,t,r):!1;for(var n=e.classList.length;n--;){var s=e.classList[n];if(t.test(s))return!0}return r?Ke(e.parentNode,t,r):!1}function Rt(e,t,r){try{var n=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(n===null)return!1;if(typeof t=="string"){if(n.classList.contains(t)||n.closest(".".concat(t)))return!0}else if(Ke(n,t,!0))return!0;if(r&&(n.matches(r)||n.closest(r)))return!0}catch{}return!1}function mr(e,t,r){var n=e.contentWindow;if(n){var s=!1,a;try{a=n.document.readyState}catch{return}if(a!=="complete"){var l=setTimeout(function(){s||(t(),s=!0)},r);e.addEventListener("load",function(){clearTimeout(l),s=!0,t()});return}var o="about:blank";if(n.location.href!==o||e.src===o||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}}function Ir(e,t,r){var n=!1,s;try{s=e.sheet}catch{return}if(!s){var a=setTimeout(function(){n||(t(),n=!0)},r);e.addEventListener("load",function(){clearTimeout(a),n=!0,t()})}}function Cr(e,t){var r=t.doc,n=t.mirror,s=t.blockClass,a=t.blockSelector,l=t.maskTextClass,o=t.maskTextSelector,i=t.inlineStylesheet,c=t.maskInputOptions,d=c===void 0?{}:c,u=t.maskTextFn,f=t.maskInputFn,p=t.dataURLOptions,h=p===void 0?{}:p,g=t.inlineImages,C=t.recordCanvas,b=t.keepIframeSrcFn,I=t.newlyAddedElement,m=I===void 0?!1:I,R=yr(r,n);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:B.Document,childNodes:[],compatMode:e.compatMode}:{type:B.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:B.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:R};case e.ELEMENT_NODE:return vr(e,{doc:r,blockClass:s,blockSelector:a,inlineStylesheet:i,maskInputOptions:d,maskInputFn:f,dataURLOptions:h,inlineImages:g,recordCanvas:C,keepIframeSrcFn:b,newlyAddedElement:m,rootId:R});case e.TEXT_NODE:return Sr(e,{maskTextClass:l,maskTextSelector:o,maskTextFn:u,rootId:R});case e.CDATA_SECTION_NODE:return{type:B.CDATA,textContent:"",rootId:R};case e.COMMENT_NODE:return{type:B.Comment,textContent:e.textContent||"",rootId:R};default:return!1}}function yr(e,t){if(t.hasNode(e)){var r=t.getId(e);return r===1?void 0:r}}function Sr(e,t){var r,n=t.maskTextClass,s=t.maskTextSelector,a=t.maskTextFn,l=t.rootId,o=e.parentNode&&e.parentNode.tagName,i=e.textContent,c=o==="STYLE"?!0:void 0,d=o==="SCRIPT"?!0:void 0;if(c&&i){try{e.nextSibling||e.previousSibling||!((r=e.parentNode.sheet)===null||r===void 0)&&r.cssRules&&(i=Ve(e.parentNode.sheet))}catch(u){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(u),e)}i=Ue(i,nt())}return d&&(i="SCRIPT_PLACEHOLDER"),!c&&!d&&i&&Rt(e,n,s)&&(i=a?a(i):i.replace(/[\S]/g,"*")),{type:B.Text,textContent:i||"",isStyle:c,rootId:l}}function vr(e,t){for(var r=t.doc,n=t.blockClass,s=t.blockSelector,a=t.inlineStylesheet,l=t.maskInputOptions,o=l===void 0?{}:l,i=t.maskInputFn,c=t.dataURLOptions,d=c===void 0?{}:c,u=t.inlineImages,f=t.recordCanvas,p=t.keepIframeSrcFn,h=t.newlyAddedElement,g=h===void 0?!1:h,C=t.rootId,b=gr(e,n,s),I=ir(e),m={},R=e.attributes.length,F=0;F<R;F++){var D=e.attributes[F];Tt(I,D.name,D.value)||(m[D.name]=kt(r,I,fe(D.name),D.value))}if(I==="link"&&a){var L=Array.from(r.styleSheets).find(function(q){return q.href===e.href}),k=null;L&&(k=Ve(L)),k&&(delete m.rel,delete m.href,m._cssText=Ue(k,L.href))}if(I==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){var k=Ve(e.sheet);k&&(m._cssText=Ue(k,nt()))}if(I==="input"||I==="textarea"||I==="select"){var J=e.value,G=e.checked;if(m.type!=="radio"&&m.type!=="checkbox"&&m.type!=="submit"&&m.type!=="button"&&J){var Z=rt(e);m.value=tt({element:e,type:Z,tagName:I,value:J,maskInputOptions:o,maskInputFn:i})}else G&&(m.checked=G)}if(I==="option"&&(e.selected&&!o.select?m.selected=!0:delete m.selected),I==="canvas"&&f){if(e.__context==="2d")rr(e)||(m.rr_dataURL=e.toDataURL(d.type,d.quality));else if(!("__context"in e)){var $=e.toDataURL(d.type,d.quality),Q=document.createElement("canvas");Q.width=e.width,Q.height=e.height;var le=Q.toDataURL(d.type,d.quality);$!==le&&(m.rr_dataURL=$)}}if(I==="img"&&u){Ce||(Ce=r.createElement("canvas"),ut=Ce.getContext("2d"));var E=e,Y=E.crossOrigin;E.crossOrigin="anonymous";var ee=function(){E.removeEventListener("load",ee);try{Ce.width=E.naturalWidth,Ce.height=E.naturalHeight,ut.drawImage(E,0,0),m.rr_dataURL=Ce.toDataURL(d.type,d.quality)}catch(q){console.warn("Cannot inline img src=".concat(E.currentSrc,"! Error: ").concat(q))}Y?m.crossOrigin=Y:E.removeAttribute("crossorigin")};E.complete&&E.naturalWidth!==0?ee():E.addEventListener("load",ee)}if((I==="audio"||I==="video")&&(m.rr_mediaState=e.paused?"paused":"played",m.rr_mediaCurrentTime=e.currentTime),g||(e.scrollLeft&&(m.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(m.rr_scrollTop=e.scrollTop)),b){var te=e.getBoundingClientRect(),X=te.width,j=te.height;m={class:m.class,rr_width:"".concat(X,"px"),rr_height:"".concat(j,"px")}}return I==="iframe"&&!p(m.src)&&(e.contentDocument||(m.rr_src=m.src),delete m.src),{type:B.Element,tagName:I,attributes:m,childNodes:[],isSVG:fr(e)||void 0,needBlock:b,rootId:C}}function T(e){return e==null?"":e.toLowerCase()}function br(e,t){if(t.comment&&e.type===B.Comment)return!0;if(e.type===B.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(T(e.attributes.name).match(/^msapplication-tile(image|color)$/)||T(e.attributes.name)==="application-name"||T(e.attributes.rel)==="icon"||T(e.attributes.rel)==="apple-touch-icon"||T(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&T(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(T(e.attributes.property).match(/^(og|twitter|fb):/)||T(e.attributes.name).match(/^(og|twitter):/)||T(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(T(e.attributes.name)==="robots"||T(e.attributes.name)==="googlebot"||T(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(T(e.attributes.name)==="author"||T(e.attributes.name)==="generator"||T(e.attributes.name)==="framework"||T(e.attributes.name)==="publisher"||T(e.attributes.name)==="progid"||T(e.attributes.property).match(/^article:/)||T(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(T(e.attributes.name)==="google-site-verification"||T(e.attributes.name)==="yandex-verification"||T(e.attributes.name)==="csrf-token"||T(e.attributes.name)==="p:domain_verify"||T(e.attributes.name)==="verify-v1"||T(e.attributes.name)==="verification"||T(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function be(e,t){var r=t.doc,n=t.mirror,s=t.blockClass,a=t.blockSelector,l=t.maskTextClass,o=t.maskTextSelector,i=t.skipChild,c=i===void 0?!1:i,d=t.inlineStylesheet,u=d===void 0?!0:d,f=t.maskInputOptions,p=f===void 0?{}:f,h=t.maskTextFn,g=t.maskInputFn,C=t.slimDOMOptions,b=t.dataURLOptions,I=b===void 0?{}:b,m=t.inlineImages,R=m===void 0?!1:m,F=t.recordCanvas,D=F===void 0?!1:F,L=t.onSerialize,k=t.onIframeLoad,J=t.iframeLoadTimeout,G=J===void 0?5e3:J,Z=t.onStylesheetLoad,$=t.stylesheetLoadTimeout,Q=$===void 0?5e3:$,le=t.keepIframeSrcFn,E=le===void 0?function(){return!1}:le,Y=t.newlyAddedElement,ee=Y===void 0?!1:Y,te=t.preserveWhiteSpace,X=te===void 0?!0:te,j=Cr(e,{doc:r,mirror:n,blockClass:s,blockSelector:a,maskTextClass:l,maskTextSelector:o,inlineStylesheet:u,maskInputOptions:p,maskTextFn:h,maskInputFn:g,dataURLOptions:I,inlineImages:R,recordCanvas:D,keepIframeSrcFn:E,newlyAddedElement:ee});if(!j)return console.warn(e,"not serialized"),null;var q;n.hasNode(e)?q=n.getId(e):br(j,C)||!X&&j.type===B.Text&&!j.isStyle&&!j.textContent.replace(/^\s+|\s+$/gm,"").length?q=Ee:q=Mt();var N=Object.assign(j,{id:q});if(n.add(e,N),q===Ee)return null;L&&L(e);var ge=!c;if(N.type===B.Element){ge=ge&&!N.needBlock,delete N.needBlock;var ke=e.shadowRoot;ke&&Ne(ke)&&(N.isShadowHost=!0)}if((N.type===B.Document||N.type===B.Element)&&ge){C.headWhitespace&&N.type===B.Element&&N.tagName==="head"&&(X=!1);for(var De={doc:r,mirror:n,blockClass:s,blockSelector:a,maskTextClass:l,maskTextSelector:o,skipChild:c,inlineStylesheet:u,maskInputOptions:p,maskTextFn:h,maskInputFn:g,slimDOMOptions:C,dataURLOptions:I,inlineImages:R,recordCanvas:D,preserveWhiteSpace:X,onSerialize:L,onIframeLoad:k,iframeLoadTimeout:G,onStylesheetLoad:Z,stylesheetLoadTimeout:Q,keepIframeSrcFn:E},re=0,ae=Array.from(e.childNodes);re<ae.length;re++){var ce=ae[re],ne=be(ce,De);ne&&N.childNodes.push(ne)}if(Xt(e)&&e.shadowRoot)for(var y=0,K=Array.from(e.shadowRoot.childNodes);y<K.length;y++){var ce=K[y],ne=be(ce,De);ne&&(Ne(e.shadowRoot)&&(ne.isShadow=!0),N.childNodes.push(ne))}}return e.parentNode&&Re(e.parentNode)&&Ne(e.parentNode)&&(N.isShadow=!0),N.type===B.Element&&N.tagName==="iframe"&&mr(e,function(){var w=e.contentDocument;if(w&&k){var _=be(w,{doc:w,mirror:n,blockClass:s,blockSelector:a,maskTextClass:l,maskTextSelector:o,skipChild:!1,inlineStylesheet:u,maskInputOptions:p,maskTextFn:h,maskInputFn:g,slimDOMOptions:C,dataURLOptions:I,inlineImages:R,recordCanvas:D,preserveWhiteSpace:X,onSerialize:L,onIframeLoad:k,iframeLoadTimeout:G,onStylesheetLoad:Z,stylesheetLoadTimeout:Q,keepIframeSrcFn:E});_&&k(e,_)}},G),N.type===B.Element&&N.tagName==="link"&&N.attributes.rel==="stylesheet"&&Ir(e,function(){if(Z){var w=be(e,{doc:r,mirror:n,blockClass:s,blockSelector:a,maskTextClass:l,maskTextSelector:o,skipChild:!1,inlineStylesheet:u,maskInputOptions:p,maskTextFn:h,maskInputFn:g,slimDOMOptions:C,dataURLOptions:I,inlineImages:R,recordCanvas:D,preserveWhiteSpace:X,onSerialize:L,onIframeLoad:k,iframeLoadTimeout:G,onStylesheetLoad:Z,stylesheetLoadTimeout:Q,keepIframeSrcFn:E});w&&Z(e,w)}},Q),N}function Ar(e,t){var r=t||{},n=r.mirror,s=n===void 0?new wt:n,a=r.blockClass,l=a===void 0?"rr-block":a,o=r.blockSelector,i=o===void 0?null:o,c=r.maskTextClass,d=c===void 0?"rr-mask":c,u=r.maskTextSelector,f=u===void 0?null:u,p=r.inlineStylesheet,h=p===void 0?!0:p,g=r.inlineImages,C=g===void 0?!1:g,b=r.recordCanvas,I=b===void 0?!1:b,m=r.maskAllInputs,R=m===void 0?!1:m,F=r.maskTextFn,D=r.maskInputFn,L=r.slimDOM,k=L===void 0?!1:L,J=r.dataURLOptions,G=r.preserveWhiteSpace,Z=r.onSerialize,$=r.onIframeLoad,Q=r.iframeLoadTimeout,le=r.onStylesheetLoad,E=r.stylesheetLoadTimeout,Y=r.keepIframeSrcFn,ee=Y===void 0?function(){return!1}:Y,te=R===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:R===!1?{password:!0}:R,X=k===!0||k==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:k==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:k===!1?{}:k;return be(e,{doc:e,mirror:s,blockClass:l,blockSelector:i,maskTextClass:d,maskTextSelector:f,skipChild:!1,inlineStylesheet:h,maskInputOptions:te,maskTextFn:F,maskInputFn:D,slimDOMOptions:X,dataURLOptions:J,inlineImages:C,recordCanvas:I,preserveWhiteSpace:G,onSerialize:Z,onIframeLoad:$,iframeLoadTimeout:Q,onStylesheetLoad:le,stylesheetLoadTimeout:E,keepIframeSrcFn:ee,newlyAddedElement:!1})}function V(e,t,r=document){const n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}const Se=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let ht={map:{},getId(){return console.error(Se),-1},getNode(){return console.error(Se),null},removeNodeFromMap(){console.error(Se)},has(){return console.error(Se),!1},reset(){console.error(Se)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(ht=new Proxy(ht,{get(e,t,r){return t==="map"&&console.error(Se),Reflect.get(e,t,r)}}));function Fe(e,t,r={}){let n=null,s=0;return function(...a){const l=Date.now();!s&&r.leading===!1&&(s=l);const o=t-(l-s),i=this;o<=0||o>t?(n&&(clearTimeout(n),n=null),s=l,e.apply(i,a)):!n&&r.trailing!==!1&&(n=setTimeout(()=>{s=r.leading===!1?0:Date.now(),n=null,e.apply(i,a)},o))}}function Pe(e,t,r,n,s=window){const a=s.Object.getOwnPropertyDescriptor(e,t);return s.Object.defineProperty(e,t,n?r:{set(l){setTimeout(()=>{r.set.call(this,l)},0),a&&a.set&&a.set.call(this,l)}}),()=>Pe(e,t,a||{},!0)}function xe(e,t,r){try{if(!(t in e))return()=>{};const n=e[t],s=r(n);return typeof s=="function"&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:n}})),e[t]=s,()=>{e[t]=n}}catch{return()=>{}}}let He=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(He=()=>new Date().getTime());function Nt(e){var t,r,n,s,a,l;const o=e.document;return{left:o.scrollingElement?o.scrollingElement.scrollLeft:e.pageXOffset!==void 0?e.pageXOffset:(o==null?void 0:o.documentElement.scrollLeft)||((r=(t=o==null?void 0:o.body)===null||t===void 0?void 0:t.parentElement)===null||r===void 0?void 0:r.scrollLeft)||((n=o==null?void 0:o.body)===null||n===void 0?void 0:n.scrollLeft)||0,top:o.scrollingElement?o.scrollingElement.scrollTop:e.pageYOffset!==void 0?e.pageYOffset:(o==null?void 0:o.documentElement.scrollTop)||((a=(s=o==null?void 0:o.body)===null||s===void 0?void 0:s.parentElement)===null||a===void 0?void 0:a.scrollTop)||((l=o==null?void 0:o.body)===null||l===void 0?void 0:l.scrollTop)||0}}function Ot(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Et(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function U(e,t,r,n){if(!e)return!1;const s=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!s)return!1;try{if(typeof t=="string"){if(s.classList.contains(t)||n&&s.closest("."+t)!==null)return!0}else if(Ke(s,t,n))return!0}catch{}return!!(r&&(s.matches(r)||n&&s.closest(r)!==null))}function wr(e,t){return t.getId(e)!==-1}function Xe(e,t){return t.getId(e)===Ee}function Ft(e,t){if(Re(e))return!1;const r=t.getId(e);return t.has(r)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?Ft(e.parentNode,t):!0:!0}function qe(e){return!!e.changedTouches}function Mr(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let r=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===r)return!0;while(r=r&&r.parentNode);return!1})}function xt(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function Lt(e,t){return!!(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function $e(e){return!!(e!=null&&e.shadowRoot)}class kr{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var r;return(r=this.styleIDMap.get(t))!==null&&r!==void 0?r:-1}has(t){return this.styleIDMap.has(t)}add(t,r){if(this.has(t))return this.getId(t);let n;return r===void 0?n=this.id++:n=r,this.styleIDMap.set(t,n),this.idStyleMap.set(n,t),n}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function Dt(e){var t,r;let n=null;return((r=(t=e.getRootNode)===null||t===void 0?void 0:t.call(e))===null||r===void 0?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(n=e.getRootNode().host),n}function Tr(e){let t=e,r;for(;r=Dt(t);)t=r;return t}function Rr(e){const t=e.ownerDocument;if(!t)return!1;const r=Tr(e);return t.contains(r)}function Wt(e){const t=e.ownerDocument;return t?t.contains(e)||Rr(e):!1}var A=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(A||{}),v=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(v||{}),H=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(H||{}),oe=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(oe||{}),we=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(we||{});function pt(e){return"__ln"in e}class Nr{constructor(){this.length=0,this.head=null,this.tail=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let n=0;n<t;n++)r=(r==null?void 0:r.next)||null;return r}addNode(t){const r={value:t,previous:null,next:null};if(t.__ln=r,t.previousSibling&&pt(t.previousSibling)){const n=t.previousSibling.__ln.next;r.next=n,r.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=r,n&&(n.previous=r)}else if(t.nextSibling&&pt(t.nextSibling)&&t.nextSibling.__ln.previous){const n=t.nextSibling.__ln.previous;r.previous=n,r.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=r,n&&(n.next=r)}else this.head&&(this.head.previous=r),r.next=this.head,this.head=r;r.next===null&&(this.tail=r),this.length++}removeNode(t){const r=t.__ln;this.head&&(r.previous?(r.previous.next=r.next,r.next?r.next.previous=r.previous:this.tail=r.previous):(this.head=r.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const ft=(e,t)=>`${e}@${t}`;class Or{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],r=new Set,n=new Nr,s=i=>{let c=i,d=Ee;for(;d===Ee;)c=c&&c.nextSibling,d=c&&this.mirror.getId(c);return d},a=i=>{if(!i.parentNode||!Wt(i))return;const c=Re(i.parentNode)?this.mirror.getId(Dt(i)):this.mirror.getId(i.parentNode),d=s(i);if(c===-1||d===-1)return n.addNode(i);const u=be(i,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:f=>{xt(f,this.mirror)&&this.iframeManager.addIframe(f),Lt(f,this.mirror)&&this.stylesheetManager.trackLinkElement(f),$e(i)&&this.shadowDomManager.addShadowRoot(i.shadowRoot,this.doc)},onIframeLoad:(f,p)=>{this.iframeManager.attachIframe(f,p),this.shadowDomManager.observeAttachShadow(f)},onStylesheetLoad:(f,p)=>{this.stylesheetManager.attachLinkElement(f,p)}});u&&(t.push({parentId:c,nextId:d,node:u}),r.add(u.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const i of this.movedSet)gt(this.removes,i,this.mirror)&&!this.movedSet.has(i.parentNode)||a(i);for(const i of this.addedSet)!mt(this.droppedSet,i)&&!gt(this.removes,i,this.mirror)||mt(this.movedSet,i)?a(i):this.droppedSet.add(i);let l=null;for(;n.length;){let i=null;if(l){const c=this.mirror.getId(l.value.parentNode),d=s(l.value);c!==-1&&d!==-1&&(i=l)}if(!i){let c=n.tail;for(;c;){const d=c;if(c=c.previous,d){const u=this.mirror.getId(d.value.parentNode);if(s(d.value)===-1)continue;if(u!==-1){i=d;break}else{const p=d.value;if(p.parentNode&&p.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const h=p.parentNode.host;if(this.mirror.getId(h)!==-1){i=d;break}}}}}}if(!i){for(;n.head;)n.removeNode(n.head.value);break}l=i.previous,n.removeNode(i.value),a(i.value)}const o={texts:this.texts.map(i=>({id:this.mirror.getId(i.node),value:i.value})).filter(i=>!r.has(i.id)).filter(i=>this.mirror.has(i.id)),attributes:this.attributes.map(i=>{const{attributes:c}=i;if(typeof c.style=="string"){const d=JSON.stringify(i.styleDiff),u=JSON.stringify(i._unchangedStyles);d.length<c.style.length&&(d+u).split("var(").length===c.style.split("var(").length&&(c.style=i.styleDiff)}return{id:this.mirror.getId(i.node),attributes:c}}).filter(i=>!r.has(i.id)).filter(i=>this.mirror.has(i.id)),removes:this.removes,adds:t};!o.texts.length&&!o.attributes.length&&!o.removes.length&&!o.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(o))},this.processMutation=t=>{if(Xe(t.target,this.mirror))return;let r;try{r=document.implementation.createHTMLDocument()}catch{r=this.doc}switch(t.type){case"characterData":{const n=t.target.textContent;!U(t.target,this.blockClass,this.blockSelector,!1)&&n!==t.oldValue&&this.texts.push({value:Rt(t.target,this.maskTextClass,this.maskTextSelector)&&n?this.maskTextFn?this.maskTextFn(n):n.replace(/[\S]/g,"*"):n,node:t.target});break}case"attributes":{const n=t.target;let s=t.attributeName,a=t.target.getAttribute(s);if(s==="value"){const o=rt(n);a=tt({element:n,maskInputOptions:this.maskInputOptions,tagName:n.tagName,type:o,value:a,maskInputFn:this.maskInputFn})}if(U(t.target,this.blockClass,this.blockSelector,!1)||a===t.oldValue)return;let l=this.attributes.find(o=>o.node===t.target);if(n.tagName==="IFRAME"&&s==="src"&&!this.keepIframeSrcFn(a))if(!n.contentDocument)s="rr_src";else return;if(l||(l={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(l)),s==="type"&&n.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&n.setAttribute("data-rr-is-password","true"),!Tt(n.tagName,s)&&(l.attributes[s]=kt(this.doc,fe(n.tagName),fe(s),a),s==="style")){const o=r.createElement("span");t.oldValue&&o.setAttribute("style",t.oldValue);for(const i of Array.from(n.style)){const c=n.style.getPropertyValue(i),d=n.style.getPropertyPriority(i);c!==o.style.getPropertyValue(i)||d!==o.style.getPropertyPriority(i)?d===""?l.styleDiff[i]=c:l.styleDiff[i]=[c,d]:l._unchangedStyles[i]=[c,d]}for(const i of Array.from(o.style))n.style.getPropertyValue(i)===""&&(l.styleDiff[i]=!1)}break}case"childList":{if(U(t.target,this.blockClass,this.blockSelector,!0))return;t.addedNodes.forEach(n=>this.genAdds(n,t.target)),t.removedNodes.forEach(n=>{const s=this.mirror.getId(n),a=Re(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);U(t.target,this.blockClass,this.blockSelector,!1)||Xe(n,this.mirror)||!wr(n,this.mirror)||(this.addedSet.has(n)?(et(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(t.target)&&s===-1||Ft(t.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[ft(s,a)]?et(this.movedSet,n):this.removes.push({parentId:a,id:s,isShadow:Re(t.target)&&Ne(t.target)?!0:void 0})),this.mapRemoves.push(n))});break}}},this.genAdds=(t,r)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!(this.addedSet.has(t)||this.movedSet.has(t))){if(this.mirror.hasNode(t)){if(Xe(t,this.mirror))return;this.movedSet.add(t);let n=null;r&&this.mirror.hasNode(r)&&(n=this.mirror.getId(r)),n&&n!==-1&&(this.movedMap[ft(this.mirror.getId(t),n)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);U(t,this.blockClass,this.blockSelector,!1)||(t.childNodes.forEach(n=>this.genAdds(n)),$e(t)&&t.shadowRoot.childNodes.forEach(n=>{this.processedNodeManager.add(n,this),this.genAdds(n,t)}))}}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(r=>{this[r]=t[r]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function et(e,t){e.delete(t),t.childNodes.forEach(r=>et(e,r))}function gt(e,t,r){return e.length===0?!1:Bt(e,t,r)}function Bt(e,t,r){const{parentNode:n}=t;if(!n)return!1;const s=r.getId(n);return e.some(a=>a.id===s)?!0:Bt(e,n,r)}function mt(e,t){return e.size===0?!1:_t(e,t)}function _t(e,t){const{parentNode:r}=t;return r?e.has(r)?!0:_t(e,r):!1}let Oe;function Er(e){Oe=e}function Fr(){Oe=void 0}const S=e=>Oe?(...r)=>{try{return e(...r)}catch(n){if(Oe&&Oe(n)===!0)return;throw n}}:e,he=[];function Le(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function Gt(e,t){var r,n;const s=new Or;he.push(s),s.init(e);let a=window.MutationObserver||window.__rrMutationObserver;const l=(n=(r=window==null?void 0:window.Zone)===null||r===void 0?void 0:r.__symbol__)===null||n===void 0?void 0:n.call(r,"MutationObserver");l&&window[l]&&(a=window[l]);const o=new a(S(s.processMutations.bind(s)));return o.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),o}function xr({mousemoveCb:e,sampling:t,doc:r,mirror:n}){if(t.mousemove===!1)return()=>{};const s=typeof t.mousemove=="number"?t.mousemove:50,a=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let l=[],o;const i=Fe(S(u=>{const f=Date.now()-o;e(l.map(p=>(p.timeOffset-=f,p)),u),l=[],o=null}),a),c=S(Fe(S(u=>{const f=Le(u),{clientX:p,clientY:h}=qe(u)?u.changedTouches[0]:u;o||(o=He()),l.push({x:p,y:h,id:n.getId(f),timeOffset:He()-o}),i(typeof DragEvent<"u"&&u instanceof DragEvent?v.Drag:u instanceof MouseEvent?v.MouseMove:v.TouchMove)}),s,{trailing:!1})),d=[V("mousemove",c,r),V("touchmove",c,r),V("drag",c,r)];return S(()=>{d.forEach(u=>u())})}function Lr({mouseInteractionCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,sampling:a}){if(a.mouseInteraction===!1)return()=>{};const l=a.mouseInteraction===!0||a.mouseInteraction===void 0?{}:a.mouseInteraction,o=[];let i=null;const c=d=>u=>{const f=Le(u);if(U(f,n,s,!0))return;let p=null,h=d;if("pointerType"in u){switch(u.pointerType){case"mouse":p=oe.Mouse;break;case"touch":p=oe.Touch;break;case"pen":p=oe.Pen;break}p===oe.Touch?H[d]===H.MouseDown?h="TouchStart":H[d]===H.MouseUp&&(h="TouchEnd"):oe.Pen}else qe(u)&&(p=oe.Touch);p!==null?(i=p,(h.startsWith("Touch")&&p===oe.Touch||h.startsWith("Mouse")&&p===oe.Mouse)&&(p=null)):H[d]===H.Click&&(p=i,i=null);const g=qe(u)?u.changedTouches[0]:u;if(!g)return;const C=r.getId(f),{clientX:b,clientY:I}=g;S(e)(Object.assign({type:H[h],id:C,x:b,y:I},p!==null&&{pointerType:p}))};return Object.keys(H).filter(d=>Number.isNaN(Number(d))&&!d.endsWith("_Departed")&&l[d]!==!1).forEach(d=>{let u=fe(d);const f=c(d);if(window.PointerEvent)switch(H[d]){case H.MouseDown:case H.MouseUp:u=u.replace("mouse","pointer");break;case H.TouchStart:case H.TouchEnd:return}o.push(V(u,f,t))}),S(()=>{o.forEach(d=>d())})}function Zt({scrollCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,sampling:a}){const l=S(Fe(S(o=>{const i=Le(o);if(!i||U(i,n,s,!0))return;const c=r.getId(i);if(i===t&&t.defaultView){const d=Nt(t.defaultView);e({id:c,x:d.left,y:d.top})}else e({id:c,x:i.scrollLeft,y:i.scrollTop})}),a.scroll||100));return V("scroll",l,t)}function Dr({viewportResizeCb:e},{win:t}){let r=-1,n=-1;const s=S(Fe(S(()=>{const a=Ot(),l=Et();(r!==a||n!==l)&&(e({width:Number(l),height:Number(a)}),r=a,n=l)}),200));return V("resize",s,t)}function It(e,t){const r=Object.assign({},e);return t||delete r.userTriggered,r}const Wr=["INPUT","TEXTAREA","SELECT"],Ct=new WeakMap;function Br({inputCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,ignoreClass:a,ignoreSelector:l,maskInputOptions:o,maskInputFn:i,sampling:c,userTriggeredOnInput:d}){function u(I){let m=Le(I);const R=I.isTrusted,F=m&&m.tagName;if(m&&F==="OPTION"&&(m=m.parentElement),!m||!F||Wr.indexOf(F)<0||U(m,n,s,!0)||m.classList.contains(a)||l&&m.matches(l))return;let D=m.value,L=!1;const k=rt(m)||"";k==="radio"||k==="checkbox"?L=m.checked:(o[F.toLowerCase()]||o[k])&&(D=tt({element:m,maskInputOptions:o,tagName:F,type:k,value:D,maskInputFn:i})),f(m,S(It)({text:D,isChecked:L,userTriggered:R},d));const J=m.name;k==="radio"&&J&&L&&t.querySelectorAll(`input[type="radio"][name="${J}"]`).forEach(G=>{G!==m&&f(G,S(It)({text:G.value,isChecked:!L,userTriggered:!1},d))})}function f(I,m){const R=Ct.get(I);if(!R||R.text!==m.text||R.isChecked!==m.isChecked){Ct.set(I,m);const F=r.getId(I);S(e)(Object.assign(Object.assign({},m),{id:F}))}}const h=(c.input==="last"?["change"]:["input","change"]).map(I=>V(I,S(u),t)),g=t.defaultView;if(!g)return()=>{h.forEach(I=>I())};const C=g.Object.getOwnPropertyDescriptor(g.HTMLInputElement.prototype,"value"),b=[[g.HTMLInputElement.prototype,"value"],[g.HTMLInputElement.prototype,"checked"],[g.HTMLSelectElement.prototype,"value"],[g.HTMLTextAreaElement.prototype,"value"],[g.HTMLSelectElement.prototype,"selectedIndex"],[g.HTMLOptionElement.prototype,"selected"]];return C&&C.set&&h.push(...b.map(I=>Pe(I[0],I[1],{set(){S(u)({target:this,isTrusted:!1})}},!1,g))),S(()=>{h.forEach(I=>I())})}function ze(e){const t=[];function r(n,s){if(We("CSSGroupingRule")&&n.parentRule instanceof CSSGroupingRule||We("CSSMediaRule")&&n.parentRule instanceof CSSMediaRule||We("CSSSupportsRule")&&n.parentRule instanceof CSSSupportsRule||We("CSSConditionRule")&&n.parentRule instanceof CSSConditionRule){const l=Array.from(n.parentRule.cssRules).indexOf(n);s.unshift(l)}else if(n.parentStyleSheet){const l=Array.from(n.parentStyleSheet.cssRules).indexOf(n);s.unshift(l)}return s}return r(e,t)}function de(e,t,r){let n,s;return e?(e.ownerNode?n=t.getId(e.ownerNode):s=r.getId(e),{styleId:s,id:n}):{}}function _r({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:n}){if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};const s=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:S((d,u,f)=>{const[p,h]=f,{id:g,styleId:C}=de(u,t,r.styleMirror);return(g&&g!==-1||C&&C!==-1)&&e({id:g,styleId:C,adds:[{rule:p,index:h}]}),d.apply(u,f)})});const a=n.CSSStyleSheet.prototype.deleteRule;n.CSSStyleSheet.prototype.deleteRule=new Proxy(a,{apply:S((d,u,f)=>{const[p]=f,{id:h,styleId:g}=de(u,t,r.styleMirror);return(h&&h!==-1||g&&g!==-1)&&e({id:h,styleId:g,removes:[{index:p}]}),d.apply(u,f)})});let l;n.CSSStyleSheet.prototype.replace&&(l=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(l,{apply:S((d,u,f)=>{const[p]=f,{id:h,styleId:g}=de(u,t,r.styleMirror);return(h&&h!==-1||g&&g!==-1)&&e({id:h,styleId:g,replace:p}),d.apply(u,f)})}));let o;n.CSSStyleSheet.prototype.replaceSync&&(o=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(o,{apply:S((d,u,f)=>{const[p]=f,{id:h,styleId:g}=de(u,t,r.styleMirror);return(h&&h!==-1||g&&g!==-1)&&e({id:h,styleId:g,replaceSync:p}),d.apply(u,f)})}));const i={};Be("CSSGroupingRule")?i.CSSGroupingRule=n.CSSGroupingRule:(Be("CSSMediaRule")&&(i.CSSMediaRule=n.CSSMediaRule),Be("CSSConditionRule")&&(i.CSSConditionRule=n.CSSConditionRule),Be("CSSSupportsRule")&&(i.CSSSupportsRule=n.CSSSupportsRule));const c={};return Object.entries(i).forEach(([d,u])=>{c[d]={insertRule:u.prototype.insertRule,deleteRule:u.prototype.deleteRule},u.prototype.insertRule=new Proxy(c[d].insertRule,{apply:S((f,p,h)=>{const[g,C]=h,{id:b,styleId:I}=de(p.parentStyleSheet,t,r.styleMirror);return(b&&b!==-1||I&&I!==-1)&&e({id:b,styleId:I,adds:[{rule:g,index:[...ze(p),C||0]}]}),f.apply(p,h)})}),u.prototype.deleteRule=new Proxy(c[d].deleteRule,{apply:S((f,p,h)=>{const[g]=h,{id:C,styleId:b}=de(p.parentStyleSheet,t,r.styleMirror);return(C&&C!==-1||b&&b!==-1)&&e({id:C,styleId:b,removes:[{index:[...ze(p),g]}]}),f.apply(p,h)})})}),S(()=>{n.CSSStyleSheet.prototype.insertRule=s,n.CSSStyleSheet.prototype.deleteRule=a,l&&(n.CSSStyleSheet.prototype.replace=l),o&&(n.CSSStyleSheet.prototype.replaceSync=o),Object.entries(i).forEach(([d,u])=>{u.prototype.insertRule=c[d].insertRule,u.prototype.deleteRule=c[d].deleteRule})})}function Vt({mirror:e,stylesheetManager:t},r){var n,s,a;let l=null;r.nodeName==="#document"?l=e.getId(r):l=e.getId(r.host);const o=r.nodeName==="#document"?(n=r.defaultView)===null||n===void 0?void 0:n.Document:(a=(s=r.ownerDocument)===null||s===void 0?void 0:s.defaultView)===null||a===void 0?void 0:a.ShadowRoot,i=Object.getOwnPropertyDescriptor(o==null?void 0:o.prototype,"adoptedStyleSheets");return l===null||l===-1||!o||!i?()=>{}:(Object.defineProperty(r,"adoptedStyleSheets",{configurable:i.configurable,enumerable:i.enumerable,get(){var c;return(c=i.get)===null||c===void 0?void 0:c.call(this)},set(c){var d;const u=(d=i.set)===null||d===void 0?void 0:d.call(this,c);if(l!==null&&l!==-1)try{t.adoptStyleSheets(c,l)}catch{}return u}}),S(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:i.configurable,enumerable:i.enumerable,get:i.get,set:i.set})}))}function Gr({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:n},{win:s}){const a=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=new Proxy(a,{apply:S((o,i,c)=>{var d;const[u,f,p]=c;if(r.has(u))return a.apply(i,[u,f,p]);const{id:h,styleId:g}=de((d=i.parentRule)===null||d===void 0?void 0:d.parentStyleSheet,t,n.styleMirror);return(h&&h!==-1||g&&g!==-1)&&e({id:h,styleId:g,set:{property:u,value:f,priority:p},index:ze(i.parentRule)}),o.apply(i,c)})});const l=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=new Proxy(l,{apply:S((o,i,c)=>{var d;const[u]=c;if(r.has(u))return l.apply(i,[u]);const{id:f,styleId:p}=de((d=i.parentRule)===null||d===void 0?void 0:d.parentStyleSheet,t,n.styleMirror);return(f&&f!==-1||p&&p!==-1)&&e({id:f,styleId:p,remove:{property:u},index:ze(i.parentRule)}),o.apply(i,c)})}),S(()=>{s.CSSStyleDeclaration.prototype.setProperty=a,s.CSSStyleDeclaration.prototype.removeProperty=l})}function Zr({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:n,sampling:s,doc:a}){const l=S(i=>Fe(S(c=>{const d=Le(c);if(!d||U(d,t,r,!0))return;const{currentTime:u,volume:f,muted:p,playbackRate:h}=d;e({type:i,id:n.getId(d),currentTime:u,volume:f,muted:p,playbackRate:h})}),s.media||500)),o=[V("play",l(0),a),V("pause",l(1),a),V("seeked",l(2),a),V("volumechange",l(3),a),V("ratechange",l(4),a)];return S(()=>{o.forEach(i=>i())})}function Vr({fontCb:e,doc:t}){const r=t.defaultView;if(!r)return()=>{};const n=[],s=new WeakMap,a=r.FontFace;r.FontFace=function(i,c,d){const u=new a(i,c,d);return s.set(u,{family:i,buffer:typeof c!="string",descriptors:d,fontSource:typeof c=="string"?c:JSON.stringify(Array.from(new Uint8Array(c)))}),u};const l=xe(t.fonts,"add",function(o){return function(i){return setTimeout(S(()=>{const c=s.get(i);c&&(e(c),s.delete(i))}),0),o.apply(this,[i])}});return n.push(()=>{r.FontFace=a}),n.push(l),S(()=>{n.forEach(o=>o())})}function Ur(e){const{doc:t,mirror:r,blockClass:n,blockSelector:s,selectionCb:a}=e;let l=!0;const o=S(()=>{const i=t.getSelection();if(!i||l&&(i!=null&&i.isCollapsed))return;l=i.isCollapsed||!1;const c=[],d=i.rangeCount||0;for(let u=0;u<d;u++){const f=i.getRangeAt(u),{startContainer:p,startOffset:h,endContainer:g,endOffset:C}=f;U(p,n,s,!0)||U(g,n,s,!0)||c.push({start:r.getId(p),startOffset:h,end:r.getId(g),endOffset:C})}a({ranges:c})});return o(),V("selectionchange",o)}function Kr(e,t){const{mutationCb:r,mousemoveCb:n,mouseInteractionCb:s,scrollCb:a,viewportResizeCb:l,inputCb:o,mediaInteractionCb:i,styleSheetRuleCb:c,styleDeclarationCb:d,canvasMutationCb:u,fontCb:f,selectionCb:p}=e;e.mutationCb=(...h)=>{t.mutation&&t.mutation(...h),r(...h)},e.mousemoveCb=(...h)=>{t.mousemove&&t.mousemove(...h),n(...h)},e.mouseInteractionCb=(...h)=>{t.mouseInteraction&&t.mouseInteraction(...h),s(...h)},e.scrollCb=(...h)=>{t.scroll&&t.scroll(...h),a(...h)},e.viewportResizeCb=(...h)=>{t.viewportResize&&t.viewportResize(...h),l(...h)},e.inputCb=(...h)=>{t.input&&t.input(...h),o(...h)},e.mediaInteractionCb=(...h)=>{t.mediaInteaction&&t.mediaInteaction(...h),i(...h)},e.styleSheetRuleCb=(...h)=>{t.styleSheetRule&&t.styleSheetRule(...h),c(...h)},e.styleDeclarationCb=(...h)=>{t.styleDeclaration&&t.styleDeclaration(...h),d(...h)},e.canvasMutationCb=(...h)=>{t.canvasMutation&&t.canvasMutation(...h),u(...h)},e.fontCb=(...h)=>{t.font&&t.font(...h),f(...h)},e.selectionCb=(...h)=>{t.selection&&t.selection(...h),p(...h)}}function Hr(e,t={}){const r=e.doc.defaultView;if(!r)return()=>{};Kr(e,t);const n=Gt(e,e.doc),s=xr(e),a=Lr(e),l=Zt(e),o=Dr(e,{win:r}),i=Br(e),c=Zr(e),d=_r(e,{win:r}),u=Vt(e,e.doc),f=Gr(e,{win:r}),p=e.collectFonts?Vr(e):()=>{},h=Ur(e),g=[];for(const C of e.plugins)g.push(C.observer(C.callback,r,C.options));return S(()=>{he.forEach(C=>C.reset()),n.disconnect(),s(),a(),l(),o(),i(),c(),d(),u(),f(),p(),h(),g.forEach(C=>C())})}function We(e){return typeof window[e]<"u"}function Be(e){return!!(typeof window[e]<"u"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class yt{constructor(t){this.generateIdFn=t,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(t,r,n,s){const a=n||this.getIdToRemoteIdMap(t),l=s||this.getRemoteIdToIdMap(t);let o=a.get(r);return o||(o=this.generateIdFn(),a.set(r,o),l.set(o,r)),o}getIds(t,r){const n=this.getIdToRemoteIdMap(t),s=this.getRemoteIdToIdMap(t);return r.map(a=>this.getId(t,a,n,s))}getRemoteId(t,r,n){const s=n||this.getRemoteIdToIdMap(t);if(typeof r!="number")return r;const a=s.get(r);return a||-1}getRemoteIds(t,r){const n=this.getRemoteIdToIdMap(t);return r.map(s=>this.getRemoteId(t,s,n))}reset(t){if(!t){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let r=this.iframeIdToRemoteIdMap.get(t);return r||(r=new Map,this.iframeIdToRemoteIdMap.set(t,r)),r}getRemoteIdToIdMap(t){let r=this.iframeRemoteIdToIdMap.get(t);return r||(r=new Map,this.iframeRemoteIdToIdMap.set(t,r)),r}}class zr{constructor(t){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new yt(Mt),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new yt(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,r){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:r}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(n=this.loadListener)===null||n===void 0||n.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){const r=t;if(r.data.type!=="rrweb"||r.origin!==r.data.origin||!t.source)return;const s=this.crossOriginIframeMap.get(t.source);if(!s)return;const a=this.transformCrossOriginEvent(s,r.data.event);a&&this.wrappedEmit(a,r.data.isCheckout)}transformCrossOriginEvent(t,r){var n;switch(r.type){case A.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(r.data.node,t);const s=r.data.node.id;return this.crossOriginIframeRootIdMap.set(t,s),this.patchRootIdOnNode(r.data.node,s),{timestamp:r.timestamp,type:A.IncrementalSnapshot,data:{source:v.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:r.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case A.Meta:case A.Load:case A.DomContentLoaded:return!1;case A.Plugin:return r;case A.Custom:return this.replaceIds(r.data.payload,t,["id","parentId","previousId","nextId"]),r;case A.IncrementalSnapshot:switch(r.data.source){case v.Mutation:return r.data.adds.forEach(s=>{this.replaceIds(s,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(s.node,t);const a=this.crossOriginIframeRootIdMap.get(t);a&&this.patchRootIdOnNode(s.node,a)}),r.data.removes.forEach(s=>{this.replaceIds(s,t,["parentId","id"])}),r.data.attributes.forEach(s=>{this.replaceIds(s,t,["id"])}),r.data.texts.forEach(s=>{this.replaceIds(s,t,["id"])}),r;case v.Drag:case v.TouchMove:case v.MouseMove:return r.data.positions.forEach(s=>{this.replaceIds(s,t,["id"])}),r;case v.ViewportResize:return!1;case v.MediaInteraction:case v.MouseInteraction:case v.Scroll:case v.CanvasMutation:case v.Input:return this.replaceIds(r.data,t,["id"]),r;case v.StyleSheetRule:case v.StyleDeclaration:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleId"]),r;case v.Font:return r;case v.Selection:return r.data.ranges.forEach(s=>{this.replaceIds(s,t,["start","end"])}),r;case v.AdoptedStyleSheet:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleIds"]),(n=r.data.styles)===null||n===void 0||n.forEach(s=>{this.replaceStyleIds(s,t,["styleId"])}),r}}}replace(t,r,n,s){for(const a of s)!Array.isArray(r[a])&&typeof r[a]!="number"||(Array.isArray(r[a])?r[a]=t.getIds(n,r[a]):r[a]=t.getId(n,r[a]));return r}replaceIds(t,r,n){return this.replace(this.crossOriginIframeMirror,t,r,n)}replaceStyleIds(t,r,n){return this.replace(this.crossOriginIframeStyleMirror,t,r,n)}replaceIdOnNode(t,r){this.replaceIds(t,r,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach(n=>{this.replaceIdOnNode(n,r)})}patchRootIdOnNode(t,r){t.type!==B.Document&&!t.rootId&&(t.rootId=r),"childNodes"in t&&t.childNodes.forEach(n=>{this.patchRootIdOnNode(n,r)})}}class Yr{constructor(t){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,r){if(!Ne(t)||this.shadowDoms.has(t))return;this.shadowDoms.add(t);const n=Gt(Object.assign(Object.assign({},this.bypassOptions),{doc:r,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push(Zt(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),this.restoreHandlers.push(Vt({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))},0)}observeAttachShadow(t){!t.contentWindow||!t.contentDocument||this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,r){const n=this;this.restoreHandlers.push(xe(t.prototype,"attachShadow",function(s){return function(a){const l=s.call(this,a);return this.shadowRoot&&Wt(this)&&n.addShadowRoot(this.shadowRoot,r),l}}))}reset(){this.restoreHandlers.forEach(t=>{try{t()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Pr(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function Jr(e,t,r,n){function s(a){return a instanceof r?a:new r(function(l){l(a)})}return new(r||(r=Promise))(function(a,l){function o(d){try{c(n.next(d))}catch(u){l(u)}}function i(d){try{c(n.throw(d))}catch(u){l(u)}}function c(d){d.done?a(d.value):s(d.value).then(o,i)}c((n=n.apply(e,t||[])).next())})}var Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qr=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var _e=0;_e<Ae.length;_e++)Qr[Ae.charCodeAt(_e)]=_e;var Xr=function(e){var t=new Uint8Array(e),r,n=t.length,s="";for(r=0;r<n;r+=3)s+=Ae[t[r]>>2],s+=Ae[(t[r]&3)<<4|t[r+1]>>4],s+=Ae[(t[r+1]&15)<<2|t[r+2]>>6],s+=Ae[t[r+2]&63];return n%3===2?s=s.substring(0,s.length-1)+"=":n%3===1&&(s=s.substring(0,s.length-2)+"=="),s};const St=new Map;function jr(e,t){let r=St.get(e);return r||(r=new Map,St.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}const Ut=(e,t,r)=>{if(!e||!(Ht(e,t)||typeof e=="object"))return;const n=e.constructor.name,s=jr(r,n);let a=s.indexOf(e);return a===-1&&(a=s.length,s.push(e)),a};function Ge(e,t,r){if(e instanceof Array)return e.map(n=>Ge(n,t,r));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const n=e.constructor.name,s=Xr(e);return{rr_type:n,base64:s}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[Ge(e.buffer,t,r),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const n=e.constructor.name,{src:s}=e;return{rr_type:n,src:s}}else if(e instanceof HTMLCanvasElement){const n="HTMLImageElement",s=e.toDataURL();return{rr_type:n,src:s}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[Ge(e.data,t,r),e.width,e.height]};if(Ht(e,t)||typeof e=="object"){const n=e.constructor.name,s=Ut(e,t,r);return{rr_type:n,index:s}}}}return e}const Kt=(e,t,r)=>[...e].map(n=>Ge(n,t,r)),Ht=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(s=>typeof t[s]=="function").find(s=>e instanceof t[s]);function qr(e,t,r,n){const s=[],a=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const l of a)try{if(typeof t.CanvasRenderingContext2D.prototype[l]!="function")continue;const o=xe(t.CanvasRenderingContext2D.prototype,l,function(i){return function(...c){return U(this.canvas,r,n,!0)||setTimeout(()=>{const d=Kt([...c],t,this);e(this.canvas,{type:we["2D"],property:l,args:d})},0),i.apply(this,c)}});s.push(o)}catch{const i=Pe(t.CanvasRenderingContext2D.prototype,l,{set(c){e(this.canvas,{type:we["2D"],property:l,args:[c],setter:!0})}});s.push(i)}return()=>{s.forEach(l=>l())}}function $r(e){return e==="experimental-webgl"?"webgl":e}function vt(e,t,r,n){const s=[];try{const a=xe(e.HTMLCanvasElement.prototype,"getContext",function(l){return function(o,...i){if(!U(this,t,r,!0)){const c=$r(o);if("__context"in this||(this.__context=c),n&&["webgl","webgl2"].includes(c))if(i[0]&&typeof i[0]=="object"){const d=i[0];d.preserveDrawingBuffer||(d.preserveDrawingBuffer=!0)}else i.splice(0,1,{preserveDrawingBuffer:!0})}return l.apply(this,[o,...i])}});s.push(a)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{s.forEach(a=>a())}}function bt(e,t,r,n,s,a,l){const o=[],i=Object.getOwnPropertyNames(e);for(const c of i)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(c))try{if(typeof e[c]!="function")continue;const d=xe(e,c,function(u){return function(...f){const p=u.apply(this,f);if(Ut(p,l,this),"tagName"in this.canvas&&!U(this.canvas,n,s,!0)){const h=Kt([...f],l,this),g={type:t,property:c,args:h};r(this.canvas,g)}return p}});o.push(d)}catch{const u=Pe(e,c,{set(f){r(this.canvas,{type:t,property:c,args:[f],setter:!0})}});o.push(u)}return o}function en(e,t,r,n,s){const a=[];return a.push(...bt(t.WebGLRenderingContext.prototype,we.WebGL,e,r,n,s,t)),typeof t.WebGL2RenderingContext<"u"&&a.push(...bt(t.WebGL2RenderingContext.prototype,we.WebGL2,e,r,n,s,t)),()=>{a.forEach(l=>l())}}function tn(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),s=0,a=r.length;s<a;++s)n[s]=r.charCodeAt(s);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}function rn(e,t,r){var n=t===void 0?null:t,s=r===void 0?!1:r,a=tn(e,s),l=a.indexOf(`
`,10)+1,o=a.substring(l)+(n?"//# sourceMappingURL="+n:""),i=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(i)}function nn(e,t,r){var n;return function(a){return n=n||rn(e,t,r),new Worker(n,a)}}var sn=nn("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",null,!1);class an{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(i,c)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(i)||this.pendingCanvasMutations.set(i,[]),this.pendingCanvasMutations.get(i).push(c)};const{sampling:r="all",win:n,blockClass:s,blockSelector:a,recordCanvas:l,dataURLOptions:o}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,l&&r==="all"&&this.initCanvasMutationObserver(n,s,a),l&&typeof r=="number"&&this.initCanvasFPSObserver(r,n,s,a,{dataURLOptions:o})}initCanvasFPSObserver(t,r,n,s,a){const l=vt(r,n,s,!0),o=new Map,i=new sn;i.onmessage=h=>{const{id:g}=h.data;if(o.set(g,!1),!("base64"in h.data))return;const{base64:C,type:b,width:I,height:m}=h.data;this.mutationCb({id:g,type:we["2D"],commands:[{property:"clearRect",args:[0,0,I,m]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:C}],type:b}]},0,0]}]})};const c=1e3/t;let d=0,u;const f=()=>{const h=[];return r.document.querySelectorAll("canvas").forEach(g=>{U(g,n,s,!0)||h.push(g)}),h},p=h=>{if(d&&h-d<c){u=requestAnimationFrame(p);return}d=h,f().forEach(g=>Jr(this,void 0,void 0,function*(){var C;const b=this.mirror.getId(g);if(o.get(b))return;if(o.set(b,!0),["webgl","webgl2"].includes(g.__context)){const m=g.getContext(g.__context);((C=m==null?void 0:m.getContextAttributes())===null||C===void 0?void 0:C.preserveDrawingBuffer)===!1&&m.clear(m.COLOR_BUFFER_BIT)}const I=yield createImageBitmap(g);i.postMessage({id:b,bitmap:I,width:g.width,height:g.height,dataURLOptions:a.dataURLOptions},[I])})),u=requestAnimationFrame(p)};u=requestAnimationFrame(p),this.resetObservers=()=>{l(),cancelAnimationFrame(u)}}initCanvasMutationObserver(t,r,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const s=vt(t,r,n,!1),a=qr(this.processMutation.bind(this),t,r,n),l=en(this.processMutation.bind(this),t,r,n,this.mirror);this.resetObservers=()=>{s(),a(),l()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=r=>{this.rafStamps.latestId=r,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,r)=>{const n=this.mirror.getId(r);this.flushPendingCanvasMutationFor(r,n)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,r){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(t);if(!n||r===-1)return;const s=n.map(l=>Pr(l,["type"])),{type:a}=n[0];this.mutationCb({id:r,type:a,commands:s}),this.pendingCanvasMutations.delete(t)}}class on{constructor(t){this.trackedLinkElements=new WeakSet,this.styleMirror=new kr,this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,r){"_cssText"in r.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:r.id,attributes:r.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,r){if(t.length===0)return;const n={id:r,styleIds:[]},s=[];for(const a of t){let l;if(this.styleMirror.has(a))l=this.styleMirror.getId(a);else{l=this.styleMirror.add(a);const o=Array.from(a.rules||CSSRule);s.push({styleId:l,rules:o.map((i,c)=>({rule:At(i),index:c}))})}n.styleIds.push(l)}s.length>0&&(n.styles=s),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class ln{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(t,r){const n=this.nodeMap.get(t);return n&&Array.from(n).some(s=>s!==r)}add(t,r){this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(r))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}function W(e){return Object.assign(Object.assign({},e),{timestamp:He()})}let x,Ze,je,Ye=!1;const se=tr();function Me(e={}){const{emit:t,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:s="rr-block",blockSelector:a=null,ignoreClass:l="rr-ignore",ignoreSelector:o=null,maskTextClass:i="rr-mask",maskTextSelector:c=null,inlineStylesheet:d=!0,maskAllInputs:u,maskInputOptions:f,slimDOMOptions:p,maskInputFn:h,maskTextFn:g,hooks:C,packFn:b,sampling:I={},dataURLOptions:m={},mousemoveWait:R,recordCanvas:F=!1,recordCrossOriginIframes:D=!1,recordAfter:L=e.recordAfter==="DOMContentLoaded"?e.recordAfter:"load",userTriggeredOnInput:k=!1,collectFonts:J=!1,inlineImages:G=!1,plugins:Z,keepIframeSrcFn:$=()=>!1,ignoreCSSAttributes:Q=new Set([]),errorHandler:le}=e;Er(le);const E=D?window.parent===window:!0;let Y=!1;if(!E)try{window.parent.document&&(Y=!1)}catch{Y=!0}if(E&&!t)throw new Error("emit function is required");R!==void 0&&I.mousemove===void 0&&(I.mousemove=R),se.reset();const ee=u===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:f!==void 0?f:{password:!0},te=p===!0||p==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:p==="all",headMetaDescKeywords:p==="all"}:p||{};Mr();let X,j=0;const q=y=>{for(const K of Z||[])K.eventProcessor&&(y=K.eventProcessor(y));return b&&!Y&&(y=b(y)),y};x=(y,K)=>{var w;if(!((w=he[0])===null||w===void 0)&&w.isFrozen()&&y.type!==A.FullSnapshot&&!(y.type===A.IncrementalSnapshot&&y.data.source===v.Mutation)&&he.forEach(_=>_.unfreeze()),E)t==null||t(q(y),K);else if(Y){const _={type:"rrweb",event:q(y),origin:window.location.origin,isCheckout:K};window.parent.postMessage(_,"*")}if(y.type===A.FullSnapshot)X=y,j=0;else if(y.type===A.IncrementalSnapshot){if(y.data.source===v.Mutation&&y.data.isAttachIframe)return;j++;const _=n&&j>=n,ue=r&&y.timestamp-X.timestamp>r;(_||ue)&&Ze(!0)}};const N=y=>{x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.Mutation},y)}))},ge=y=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.Scroll},y)})),ke=y=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.CanvasMutation},y)})),De=y=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.AdoptedStyleSheet},y)})),re=new on({mutationCb:N,adoptedStyleSheetCb:De}),ae=new zr({mirror:se,mutationCb:N,stylesheetManager:re,recordCrossOriginIframes:D,wrappedEmit:x});for(const y of Z||[])y.getMirror&&y.getMirror({nodeMirror:se,crossOriginIframeMirror:ae.crossOriginIframeMirror,crossOriginIframeStyleMirror:ae.crossOriginIframeStyleMirror});const ce=new ln;je=new an({recordCanvas:F,mutationCb:ke,win:window,blockClass:s,blockSelector:a,mirror:se,sampling:I.canvas,dataURLOptions:m});const ne=new Yr({mutationCb:N,scrollCb:ge,bypassOptions:{blockClass:s,blockSelector:a,maskTextClass:i,maskTextSelector:c,inlineStylesheet:d,maskInputOptions:ee,dataURLOptions:m,maskTextFn:g,maskInputFn:h,recordCanvas:F,inlineImages:G,sampling:I,slimDOMOptions:te,iframeManager:ae,stylesheetManager:re,canvasManager:je,keepIframeSrcFn:$,processedNodeManager:ce},mirror:se});Ze=(y=!1)=>{x(W({type:A.Meta,data:{href:window.location.href,width:Et(),height:Ot()}}),y),re.reset(),ne.init(),he.forEach(w=>w.lock());const K=Ar(document,{mirror:se,blockClass:s,blockSelector:a,maskTextClass:i,maskTextSelector:c,inlineStylesheet:d,maskAllInputs:ee,maskTextFn:g,slimDOM:te,dataURLOptions:m,recordCanvas:F,inlineImages:G,onSerialize:w=>{xt(w,se)&&ae.addIframe(w),Lt(w,se)&&re.trackLinkElement(w),$e(w)&&ne.addShadowRoot(w.shadowRoot,document)},onIframeLoad:(w,_)=>{ae.attachIframe(w,_),ne.observeAttachShadow(w)},onStylesheetLoad:(w,_)=>{re.attachLinkElement(w,_)},keepIframeSrcFn:$});if(!K)return console.warn("Failed to snapshot the document");x(W({type:A.FullSnapshot,data:{node:K,initialOffset:Nt(window)}}),y),he.forEach(w=>w.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&re.adoptStyleSheets(document.adoptedStyleSheets,se.getId(document))};try{const y=[],K=_=>{var ue;return S(Hr)({mutationCb:N,mousemoveCb:(O,Je)=>x(W({type:A.IncrementalSnapshot,data:{source:Je,positions:O}})),mouseInteractionCb:O=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.MouseInteraction},O)})),scrollCb:ge,viewportResizeCb:O=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.ViewportResize},O)})),inputCb:O=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.Input},O)})),mediaInteractionCb:O=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.MediaInteraction},O)})),styleSheetRuleCb:O=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.StyleSheetRule},O)})),styleDeclarationCb:O=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.StyleDeclaration},O)})),canvasMutationCb:ke,fontCb:O=>x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.Font},O)})),selectionCb:O=>{x(W({type:A.IncrementalSnapshot,data:Object.assign({source:v.Selection},O)}))},blockClass:s,ignoreClass:l,ignoreSelector:o,maskTextClass:i,maskTextSelector:c,maskInputOptions:ee,inlineStylesheet:d,sampling:I,recordCanvas:F,inlineImages:G,userTriggeredOnInput:k,collectFonts:J,doc:_,maskInputFn:h,maskTextFn:g,keepIframeSrcFn:$,blockSelector:a,slimDOMOptions:te,dataURLOptions:m,mirror:se,iframeManager:ae,stylesheetManager:re,shadowDomManager:ne,processedNodeManager:ce,canvasManager:je,ignoreCSSAttributes:Q,plugins:((ue=Z==null?void 0:Z.filter(O=>O.observer))===null||ue===void 0?void 0:ue.map(O=>({observer:O.observer,options:O.options,callback:Je=>x(W({type:A.Plugin,data:{plugin:O.name,payload:Je}}))})))||[]},C)};ae.addLoadListener(_=>{try{y.push(K(_.contentDocument))}catch(ue){console.warn(ue)}});const w=()=>{Ze(),y.push(K(document)),Ye=!0};return document.readyState==="interactive"||document.readyState==="complete"?w():(y.push(V("DOMContentLoaded",()=>{x(W({type:A.DomContentLoaded,data:{}})),L==="DOMContentLoaded"&&w()})),y.push(V("load",()=>{x(W({type:A.Load,data:{}})),L==="load"&&w()},window))),()=>{y.forEach(_=>_()),ce.destroy(),Ye=!1,Fr()}}catch(y){console.warn(y)}}Me.addCustomEvent=(e,t)=>{if(!Ye)throw new Error("please add custom event after start recording");x(W({type:A.Custom,data:{tag:e,payload:t}}))};Me.freezePage=()=>{he.forEach(e=>e.freeze())};Me.takeFullSnapshot=e=>{if(!Ye)throw new Error("please take full snapshot after start recording");Ze(e)};Me.mirror=se;class ye{constructor(){this.events=[],this.cycleTimestamp=Date.now(),this.payloadBytesEstimation=0,this.hasSnapshot=!1,this.hasMeta=!1,this.hasError=!1,this.inlinedAllStylesheets=!0}add(t){this.events.push(t)}}var z,P,ie,pe;class hn{constructor(t){Te(this,z,new ye);Te(this,P,new ye);Te(this,ie,[new ye]);Te(this,pe,!1);this.recording=!1,this.currentBufferTarget=M(this,z),this.lastMeta=!1,this.parent=t,this.shouldInlineStylesheets=it(this.parent.agentIdentifier,"session_replay.inline_stylesheet"),this.shouldFix=this.shouldInlineStylesheets,this.stopRecording=()=>{}}getEvents(){var t;return(t=M(this,ie)[0])!=null&&t.events.length?{...M(this,ie)[0],type:"preloaded"}:{events:[...M(this,P).events,...M(this,z).events].filter(r=>r),type:"standard",cycleTimestamp:Math.min(M(this,P).cycleTimestamp,M(this,z).cycleTimestamp),payloadBytesEstimation:M(this,P).payloadBytesEstimation+M(this,z).payloadBytesEstimation,hasError:M(this,P).hasError||M(this,z).hasError,hasMeta:M(this,P).hasMeta||M(this,z).hasMeta,hasSnapshot:M(this,P).hasSnapshot||M(this,z).hasSnapshot,inlinedAllStylesheets:!!M(this,P).events.length&&M(this,P).inlinedAllStylesheets||M(this,z).inlinedAllStylesheets}}clearBuffer(){var t;(t=M(this,ie)[0])!=null&&t.events.length?M(this,ie).shift():this.parent.mode===Qe.ERROR?me(this,P,M(this,z)):me(this,P,new ye),me(this,z,new ye)}startRecording(){this.recording=!0;const{block_class:t,ignore_class:r,mask_text_class:n,block_selector:s,mask_input_options:a,mask_text_selector:l,mask_all_inputs:o,inline_stylesheet:i,inline_images:c,collect_fonts:d}=it(this.parent.agentIdentifier,"session_replay"),u=Me({emit:this.audit.bind(this),blockClass:t,ignoreClass:r,maskTextClass:n,blockSelector:s,maskInputOptions:a,maskTextSelector:l,maskAllInputs:o,inlineStylesheet:i,inlineImages:c,collectFonts:d,checkoutEveryNms:zt[this.parent.mode]});this.stopRecording=()=>{this.recording=!1,u()}}audit(t,r){if(this.shouldInlineStylesheets===!1||!this.shouldFix)return this.currentBufferTarget.inlinedAllStylesheets=!1,this.store(t,r);const n=dt.evaluate();!n&&M(this,pe)&&t.type===Ie.Meta&&me(this,pe,!1),n>0&&(dt.fix().then(s=>{s>0&&(this.currentBufferTarget.inlinedAllStylesheets=!1,this.shouldFix=!1),at(lt,["SessionReplay/Payload/Missing-Inline-Css/Failed",s],void 0,ot.metrics,this.parent.ee),at(lt,["SessionReplay/Payload/Missing-Inline-Css/Fixed",n-s],void 0,ot.metrics,this.parent.ee),this.takeFullSnapshot()}),(t.type===Ie.FullSnapshot||t.type===Ie.Meta)&&me(this,pe,!0)),M(this,pe)||this.store(t,r)}store(t,r){if(!t||(t.__serialized=Yt(t),!this.parent.scheduler&&M(this,ie).length?this.currentBufferTarget=M(this,ie)[M(this,ie).length-1]:this.currentBufferTarget=M(this,z),this.parent.blocked))return;const n=t.__serialized.length,s=this.getPayloadSize(n);this.parent.mode===Qe.ERROR&&r&&t.type===Ie.Meta&&this.clearBuffer(),t.type===Ie.Meta&&(this.currentBufferTarget.hasMeta=!0),t.type===Ie.FullSnapshot&&(this.currentBufferTarget.hasSnapshot=!0),this.currentBufferTarget.add(t),this.currentBufferTarget.payloadBytesEstimation+=n,s>Pt&&this.parent.mode!==Qe.ERROR&&(this.parent.scheduler?this.parent.scheduler.runHarvest():M(this,ie).push(new ye))}takeFullSnapshot(){try{if(!this.recording)return;Me.takeFullSnapshot()}catch{}}clearTimestamps(){this.currentBufferTarget.cycleTimestamp=void 0}getPayloadSize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.estimateCompression(this.currentBufferTarget.payloadBytesEstimation+t)+Jt}estimateCompression(t){return this.parent.gzipper&&this.parent.u8?t*Qt:t}}z=new WeakMap,P=new WeakMap,ie=new WeakMap,pe=new WeakMap;export{hn as Recorder};
